
title: DNS RCE CVE-2020-1350
author: Florian Roth
date: 2020/07/15
description: Detects exploitation of DNS RCE bug reported in CVE-2020-1350 by the
  detection of suspicious sub process
detection:
  SELECTION_1:
    EventID: 1
  SELECTION_2:
    ParentImage: '*\System32\dns.exe'
  SELECTION_3:
    Image:
    - '*\System32\werfault.exe'
    - '*\System32\conhost.exe'
    - '*\System32\dnscmd.exe'
  condition: (SELECTION_1 and SELECTION_2 and  not (SELECTION_3))
falsepositives:
- Unknown but benign sub processes of the Windows DNS service dns.exe
id: b5281f31-f9cc-4d0d-95d0-45b91c45b487
level: critical
logsource:
  category: process_creation
  product: windows
references:
- https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/
- https://blog.menasec.net/2019/02/threat-hunting-24-microsoft-windows-dns.html
status: experimental
tags:
- attack.initial_access
- attack.t1190
- attack.execution
- attack.t1569.002
ruletype: SIGMA
